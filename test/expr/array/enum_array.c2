// @warnings{no-unused}
module test;

import stdio local;

type Enum enum u8 { No, Yes, Maybe }

u32[Enum] a = {
    [No]= 0,
    [Yes]= 1,
    [Maybe]= 2,
}

static_assert(elemsof(a), elemsof(Enum));

type Foo enum u8 { A, B, C }

fn Enum getYes() { return Yes; }

const Enum[2] Other = { Maybe, Yes }

public fn i32 main(i32 argc, const char** argv) {
    Enum e = Maybe;

    u32[] aa = {
        a[No],
        a[Yes],
        a[Enum.Yes],
        a[argc ? Enum.Yes : Enum.No],
        a[Other[1]],
        a[getYes()],
        a[(Enum)argc],
        a[e],
        a[Enum.max],

        a[Foo.B],   // @error{array subscript must have enum type 'test.Enum'}
        a[argc],    // @error{array subscript must have enum type 'test.Enum'}
        a[No + 1],  // @error{use of undeclared identifier 'No'}
        a[1 ? Yes : // Yes is resolved as Enum.Yes
              No],  // No is resolved as Enum.No
        a[1],       // @error{array subscript must have enum type 'test.Enum'}
        a[argc],    // @error{array subscript must have enum type 'test.Enum'}
    }
    return 0;
}

